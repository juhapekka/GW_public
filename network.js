import{log as t,warn as o}from"./client.js";let n=null,r=window.location.protocol.includes("https")?"wss":"ws",a=null,c=null,s=null,l=null,i="";function e(e,o){a=e.onOpen,c=e.onMessage,s=e.onClose,l=e.onError,i=o}function S(){var e;n&&n.readyState!==WebSocket.CLOSED&&n.readyState!==WebSocket.CLOSING?n.readyState===WebSocket.OPEN?(t("Network: Socket already open."),a&&a(!0),i&&n&&n.readyState===WebSocket.OPEN&&d(JSON.stringify({type:"set_player_name",name:i}))):t("Network: Socket is already in connecting state."):(e=window.location.port?":"+window.location.port:"",e=r+"://"+window.location.hostname+e,t("Network: Attempting to connect to: "+e),(n=new WebSocket(e))&&(n.onopen=()=>{t("Network: WebSocket connection opened."),i&&d(JSON.stringify({type:"set_player_name",name:i})),a&&a(!1)},n.onmessage=o=>{if(c)try{var e=JSON.parse(o.data);c(e)}catch(e){console.error("Network: Error parsing message JSON:",e,"Raw data:",o.data)}},n.onclose=e=>{t(`Network: WebSocket connection closed. Code: ${e.code}, Reason: '${e.reason}'`);var o=n;if(n=null,s)try{s(e,o)}catch(e){console.error("[NETWORK.JS] Error inside onCloseCallback (handleSocketClose):",e)}else console.error("[NETWORK.JS] onCloseCallback IS UNDEFINED when socket closed!")},n.onerror=e=>{console.error("Network: WebSocket error occurred:",e),l&&l(e)}))}function d(e){n&&n.readyState===WebSocket.OPEN?n.send(e):o("Network: Attempted to send message, but socket is not open. Message:",e)}function k(e,o){d(JSON.stringify({type:e,...o}))}function w(e){d(JSON.stringify(e))}function N(e,o){n&&n.readyState!==WebSocket.CLOSED&&n.readyState!==WebSocket.CLOSING&&(t(`Network: Closing connection with code: ${e}, reason: `+o),n.close(e,o))}function y(){return n?n.readyState:WebSocket.CLOSED}export{e as initializeNetwork,S as connect,d as sendRawMessage,k as sendMessage,w as sendPlayerState,N as closeConnection,y as getSocketState};